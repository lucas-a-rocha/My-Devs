*https://help.sap.com/docs/SUPPORT_CONTENT/abap/3353524203.html

methods EVAL_FORMULA
    importing
      !IV_FORMULA type ZMM_LRKPI-FORMULA
    returning
      value(RV_RESULT) type STRING .

METHOD eval_formula.
    DATA:
      lv_js_code      TYPE string,
      wf_retcode      TYPE sy-subrc,
      wf_funcname(30) TYPE c,
      wf_message(70)  TYPE c,
      wf_pos          TYPE i.

    CALL FUNCTION 'CHECK_FORMULA'
      EXPORTING
        formula  = iv_formula
      IMPORTING
        subrc    = wf_retcode
        funcname = wf_funcname
        message  = wf_message
        pos      = wf_pos.

*--Create the script
    DATA(lo_jscript) = cl_java_script=>create( ).
    CONCATENATE
       'var string = ' iv_formula ';'
       'function Set_String()                     '
       '{ string = eval(string);    '        '  } '
       'Set_String();                             '
       'string;                                   '
         INTO lv_js_code SEPARATED BY cl_abap_char_utilities=>cr_lf.

    rv_result = lo_jscript->evaluate( lv_js_code ).

  ENDMETHOD.
